var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{r as s,g as i}from"./phaser-Dka3ktQ6.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var a=s();const n=i(a);class h extends a.Scene{constructor(){super("Boot")}preload(){this.loadAssets()}loadAssets(){this.load.setPath("assets"),this.load.spritesheet("tiles","tilesets/code-land.png",{frameWidth:64}),this.load.tilemapTiledJSON("map","tilemaps/player-home.json"),this.load.atlas("player","spritesheets/player.png","spritesheets/player.json"),this.load.image("cartoon-player","avatars/cartoon-player.png"),this.load.image("syntax-spider","avatars/syntax-spider.png"),this.load.audio("world","audio/opening.wav"),this.load.audio("battle","audio/battle.wav")}create(){this.scene.start("MainMenu")}}class o extends a.Scene{constructor(){super("MainMenu"),e(this,"background")}preload(){this.load.image("menu","assets/main-menu.png")}create(){const t=this.add.image(0,0,"menu").setOrigin(0,0);t.displayWidth=this.sys.canvas.width,t.displayHeight=this.sys.canvas.height,this.add.text(this.sys.canvas.width/2,this.sys.canvas.height/3,"DEMO",{fontFamily:"Arial Black",fontSize:80,color:"#ffffff",stroke:"#000000",strokeThickness:12,align:"center"}).setOrigin(.5),this.add.text(this.sys.canvas.width/2,this.sys.canvas.height/2+50,"Click here to start",{fontFamily:"Arial Black",fontSize:50,color:"#ffcc99",stroke:"#000000",strokeThickness:10,align:"center"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.startGame()))}startGame(){this.scene.start("World")}}class r extends n.Physics.Arcade.Sprite{constructor(t,s,i){super(t,s,i,"player"),e(this,"isTransitioning",!1),e(this,"isInBattle",!1),t.physics.add.existing(this),t.add.existing(this),this.setCollideWorldBounds(!0),this.initAnimations(t)}initAnimations(t){[{key:"walk-down",start:0,end:3},{key:"walk-up",start:4,end:7},{key:"walk-left",start:8,end:11},{key:"walk-right",start:12,end:15}].forEach((e=>{t.anims.create({key:e.key,frames:t.anims.generateFrameNames("player",{prefix:"player_",start:e.start,end:e.end}),frameRate:5,repeat:-1})}))}update(t,e){var s,i,a,n;if(this.isInBattle)return void this.setVelocity(0);this.setVelocity(0);const h=(null==(s=t.left)?void 0:s.isDown)?"left":(null==(i=t.right)?void 0:i.isDown)?"right":(null==(a=t.up)?void 0:a.isDown)?"up":(null==(n=t.down)?void 0:n.isDown)?"down":null;if(h){const t="left"===h||"right"===h?{x:"left"===h?-e:e,y:0}:{x:0,y:"up"===h?-e:e};this.setVelocity(t.x,t.y),this.anims.play(`walk-${h}`,!0)}this.body&&0===this.body.velocity.length()&&this.anims.stop(),this.body&&this.body.velocity.normalize().scale(e)}}const l=class t{constructor(s,i={}){e(this,"scene"),e(this,"textBox"),e(this,"isActive",!1),e(this,"textBoxBackground"),e(this,"innerFrame"),e(this,"button"),e(this,"depth",1e3),e(this,"config"),e(this,"dimensions"),e(this,"messageQueue",[]),e(this,"isProcessingQueue",!1),this.scene=s,this.config={...t.DEFAULT_CONFIG,...i},this.dimensions=this.calculateDimensions()}setDepth(t){this.depth=t,this.textBox&&this.textBox.setDepth(t),this.textBoxBackground&&this.textBoxBackground.setDepth(t),this.innerFrame&&this.innerFrame.setDepth(t),this.button&&this.button.setDepth(t)}create(t,e,s=!1){this.isActive?this.messageQueue.push({text:t,callback:e}):(this.isActive=!0,this.createBackgrounds(),this.createTextElement(),this.animateText(t,(()=>{this.isProcessingQueue=!1,null==e||e(),s&&this.closeScene(),this.processNextMessage()})))}processNextMessage(){if(0===this.messageQueue.length||this.isProcessingQueue)return;const t=this.messageQueue.shift();t&&(this.isProcessingQueue=!0,this.closeTextBox(),this.create(t.text,t.callback))}calculateDimensions(){const t=this.scene.cameras.main,e=this.config.width*t.width,s=this.config.height*t.height;return{width:e,height:s,x:(t.width-e)/2,y:t.height-s-.1*t.height}}createBackgrounds(){const{x:t,y:e,width:s,height:i}=this.dimensions,{borderRadius:a,padding:n}=this.config;this.textBoxBackground=this.createGraphics().fillStyle(3355443,.9).fillRoundedRect(t,e,s,i,a).lineStyle(2,16777215,1).strokeRoundedRect(t,e,s,i,a),this.innerFrame=this.createGraphics().lineStyle(2,16777215,1).strokeRoundedRect(t+n,e+n,s-2*n,i-2*n,a-5)}createTextElement(){const{x:t,y:e,width:s}=this.dimensions,{padding:i,fontSize:a}=this.config;this.textBox=this.scene.add.text(t+1.5*i,e+1.5*i,"",{fontSize:`${a}px`,color:"#ffffff",wordWrap:{width:s-3*i},padding:{left:i,right:i,top:i,bottom:i}}).setDepth(this.depth).setScrollFactor(0)}createButton(t,e){const{x:s,y:i,width:a,height:n}=this.dimensions,h=s+a-120,o=i+n-100;return this.scene.add.text(h,o,t,{fontSize:"28px",color:"#ffffff",backgroundColor:"#555555",padding:{left:20,right:20,top:10,bottom:10}}).setScrollFactor(0).setDepth(this.depth+1).setInteractive({useHandCursor:!0}).on("pointerdown",e)}createGraphics(){return this.scene.add.graphics().setDepth(this.depth).setScrollFactor(0)}animateText(t,e){let s=0,i=!1;const a=()=>{s<t.length&&!i&&(this.textBox.text+=t[s],s++,this.textBox.height>this.dimensions.height-3*this.config.padding?(i=!0,this.button=this.createButton("↓",(()=>{var e;i=!1,this.textBox.setText(""),null==(e=this.button)||e.destroy(),this.button=void 0,this.continueAnimation(t,s,a)}))):s>=t.length&&(this.button=this.createButton("OK",(()=>{this.closeTextBox(),null==e||e()}))))};this.continueAnimation(t,0,a)}continueAnimation(t,e,s){this.scene.time.addEvent({delay:this.config.textSpeed,callback:s,repeat:t.length-e-1})}updateText(t){if(this.textBox){this.textBox.setText("");let e=0;const s=()=>{e<t.length&&(this.textBox.text+=t[e],e++)};this.scene.time.addEvent({delay:50,callback:s,repeat:t.length-1})}}closeTextBox(){this.isActive=!1,this.textBox&&this.textBox.destroy(),this.textBoxBackground&&this.textBoxBackground.destroy(),this.innerFrame&&this.innerFrame.destroy(),this.button&&(this.button.destroy(),this.button=void 0)}closeScene(){this.scene.scene.stop()}};e(l,"DEFAULT_CONFIG",{width:.8,height:.2,fontSize:32,padding:20,borderRadius:20,textSpeed:40});let d=l;const c=320,u=180,p=1290,x=1080;class m extends a.Scene{constructor(){super("World"),e(this,"cursors"),e(this,"player"),e(this,"map"),e(this,"worldLayer"),e(this,"textBox"),e(this,"battleZones"),e(this,"canEnterBattle",!0),e(this,"lastBattleTile",null)}create(){this.initMap(),this.initPlayer(),this.initKeyboard(),this.playBackgroundMusic(),this.textBox=new d(this),this.textBox.create("Be careful! There might be 🪲 bugs 🐛 lurking about. Use the ← ↑ → ↓ keys to move around and explore..."),this.events.on("update",(()=>this.update()))}update(){var t;if(this.player&&this.cursors){if(this.scene.isPaused()||(this.player.update(this.cursors,300),null==(t=this.sound.get("world"))||t.resume()),this.battleZones&&this.canEnterBattle){const t=this.battleZones.getTileAtWorldXY(this.player.x,this.player.y);t&&t!==this.lastBattleTile?(this.lastBattleTile=t,this.startBattle()):t||(this.lastBattleTile=null)}this.player.x>this.map.widthInPixels-50&&this.exitGame()}}initMap(){this.map=this.make.tilemap({key:"map"});const t=this.map.addTilesetImage("code-land","tiles");this.map.createLayer("Below Player",t,0,0),this.map.createLayer("Below Player 2",t,0,0),this.worldLayer=this.map.createLayer("World",t,0,0);const e=this.map.createLayer("Above Player",t,0,0);null==e||e.setDepth(10),this.worldLayer.setCollisionByProperty({collides:!0}),this.physics.world.setBounds(0,0,this.map.widthInPixels,this.map.heightInPixels),this.cameras.main.setBounds(0,0,this.map.widthInPixels,this.map.heightInPixels),this.battleZones=this.map.createLayer("Battle",t,0,0),this.battleZones.setVisible(!1)}initPlayer(){this.player=new r(this,500,50),this.physics.add.collider(this.player,this.worldLayer),this.cameras.main.startFollow(this.player,!0,.09,.09)}initKeyboard(){this.input.keyboard&&(this.cursors=this.input.keyboard.createCursorKeys())}playBackgroundMusic(){this.sound.add("world",{loop:!0,volume:.5}),this.sound.play("world")}startBattle(){if(!this.canEnterBattle)return;this.canEnterBattle=!1,this.player.isInBattle=!0,this.player.isTransitioning=!0,this.player.setVelocity(0,0),this.player.anims.stop(),this.sound.pauseAll();const t=this.sound.add("battle",{volume:0,loop:!0});this.cameras.main.flash(400),this.tweens.add({targets:t,volume:.5,duration:1e3}),this.cameras.main.fadeOut(800,0,0,0),this.time.delayedCall(800,(()=>{this.scene.launch("Battle",{battleMusic:t,onBattleEnd:()=>{this.player.isInBattle=!1,this.player.isTransitioning=!1,this.sound.resumeAll(),this.scene.resume(),this.cameras.main.fadeIn(800),this.time.delayedCall(2e3,(()=>{this.canEnterBattle=!0}))}}),this.scene.pause()}))}exitGame(){this.player.isTransitioning=!0,this.player.setVelocity(0,0),this.player.anims.stop(),this.cursors.left.enabled=!1,this.cursors.right.enabled=!1,this.cursors.up.enabled=!1,this.cursors.down.enabled=!1,this.textBox.create("End of Demo - Thank you for playing!",(()=>{this.sound.stopAll(),this.cameras.main.fadeOut(250,0,0,0),this.time.delayedCall(250,(()=>{this.scene.start("MainMenu")}))}))}}class y{constructor(t,s){e(this,"scene"),e(this,"textBox"),e(this,"textBoxBackground"),e(this,"innerFrame"),e(this,"actionTexts",[]),e(this,"selectedIndex",0),e(this,"arrow"),e(this,"exitCallback"),this.scene=t,this.exitCallback=s}create(t){const e=this.scene.cameras.main,s=.5*e.width,i=.25*e.height,a=e.scrollX+(e.width-1.8*s)/2,n=e.scrollY+e.height-i-.05*e.height,h=30;this.textBoxBackground=this.scene.add.graphics(),this.textBoxBackground.fillStyle(3355443,.9),this.textBoxBackground.fillRoundedRect(a,n,s,i,20),this.textBoxBackground.lineStyle(2,16777215,1),this.textBoxBackground.strokeRoundedRect(a,n,s,i,20),this.textBoxBackground.setDepth(h),this.innerFrame=this.scene.add.graphics(),this.innerFrame.lineStyle(2,16777215,1),this.innerFrame.strokeRoundedRect(a+10,n+10,s-20,i-20,15),this.innerFrame.setDepth(h),this.textBox=this.scene.add.text(a+30,n+30,"",{fontSize:"32px",color:"#ffffff",wordWrap:{width:s},padding:{left:20,right:20,top:20,bottom:20}}),this.textBox.setDepth(h);const o=a+s+20,r=.7*s,l=i,d=this.scene.add.graphics();d.fillStyle(3355443,.9),d.fillRoundedRect(o,n,r,l,20),d.lineStyle(2,16777215,1),d.strokeRoundedRect(o,n,r,l,20),d.setDepth(h);const c=this.scene.add.graphics();c.lineStyle(2,16777215,1),c.strokeRoundedRect(o+10,n+10,r-20,l-20,15),c.setDepth(h);const u=["#ff0000","#00ff00","cyan","pink","#ffff00"];this.actionTexts=[],["DEBUG","FRIENDS","DEVTOOLS","ITEMS","RUN"].forEach(((t,e)=>{const s=this.scene.add.text(o+r/2,n+50+40*e,t,{fontSize:"35px",color:u[e],padding:{left:10,right:10,top:10,bottom:10}}).setOrigin(.5).setInteractive();s.setDepth(h),this.actionTexts.push(s)})),this.arrow=this.scene.add.text(0,0,"→",{fontSize:"28px",color:"#ffffff"}).setOrigin(.5).setDepth(h),this.updateArrowPosition(),this.scene.input.keyboard&&(this.scene.input.keyboard.on("keydown-UP",(()=>this.moveSelectionUp())),this.scene.input.keyboard.on("keydown-DOWN",(()=>this.moveSelectionDown())),this.scene.input.keyboard.on("keydown-ENTER",(()=>this.selectAction()))),this.updateText(t)}moveSelectionUp(){this.selectedIndex=(this.selectedIndex-1+this.actionTexts.length)%this.actionTexts.length,this.updateArrowPosition()}moveSelectionDown(){this.selectedIndex=(this.selectedIndex+1)%this.actionTexts.length,this.updateArrowPosition()}selectAction(){const t=this.actionTexts[this.selectedIndex].text;"RUN"===t?(this.updateText("Got away safely!"),this.scene.time.addEvent({delay:500,callback:()=>{this.closeTextBox(),this.exitCallback()}})):this.updateText(`Used ${t}!\nIt's super effective!`)}updateArrowPosition(){const t=this.actionTexts[this.selectedIndex];this.arrow.setX(t.x-t.width/2-30),this.arrow.setY(t.y)}closeTextBox(){this.textBox.setVisible(!1),this.textBoxBackground.setVisible(!1),this.innerFrame.setVisible(!1),this.arrow.setVisible(!1),this.actionTexts.forEach((t=>t.setVisible(!1))),this.textBox.setText(""),this.textBox.setDepth(0),this.textBoxBackground.clear(),this.textBoxBackground.setDepth(20),this.innerFrame.clear(),this.actionTexts=[]}updateText(t){this.textBox.setText(t),this.textBox.setWordWrapWidth(this.textBox.width)}}class g extends a.Scene{constructor(){super("Battle"),e(this,"textBox"),e(this,"battleMusic"),e(this,"onBattleEnd"),e(this,"enemyMaxHealth",100),e(this,"enemyHealth",100),e(this,"enemyHealthBar"),e(this,"enemyHealthBarInfo")}create(t){var e;this.battleMusic=t.battleMusic,this.onBattleEnd=t.onBattleEnd,this.battleMusic.play(),this.tweens.add({targets:this.battleMusic,volume:.5,duration:1e3}),this.cameras.main.fadeIn(500),this.textBox=new y(this,(()=>this.exitBattle())),this.startBattle(),null==(e=this.input.keyboard)||e.on("keydown-D",(()=>{this.enemyHealth=Math.max(0,this.enemyHealth-10),this.updateEnemyHealthBar()}))}startBattle(){this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,0).setOrigin(0,0).setAlpha(.8);const t=.5*Math.min(this.cameras.main.width,this.cameras.main.height),e=.75*this.cameras.main.width,s=.3*this.cameras.main.height,i=this.add.image(e,s,"syntax-spider");i.setScale(t/Math.max(i.width,i.height)),i.x=-i.width,this.tweens.add({targets:i,x:e,duration:1e3,ease:"Power2"});{const t=e-i.displayWidth/2,a=s-i.displayHeight/2-15,n=i.displayWidth,h=10;this.enemyHealthBarInfo={x:t,y:a,width:n,height:h},this.enemyHealthBar=this.add.graphics(),this.enemyHealthBar.setAlpha(.7),this.updateEnemyHealthBar()}this.add.text(e,s-i.displayHeight/2-30,"Mystery",{fontSize:"32px",color:"#ffffff"}).setOrigin(.5);const a=.25*this.cameras.main.width,n=.48*this.cameras.main.height,h=this.add.image(a,n,"cartoon-player");h.setScale(t/Math.max(h.width,h.height)),h.x=this.cameras.main.width+h.width,this.tweens.add({targets:h,x:a,duration:1e3,ease:"Power2"});{const t=this.add.graphics();t.setAlpha(.7);const e=a-h.displayWidth/2,s=n-h.displayHeight/2-15,i=h.displayWidth,o=10;t.fillStyle(0),t.fillRoundedRect(e-2,s-2,i+4,o+4,3),t.fillStyle(5592405),t.fillRoundedRect(e,s,i,o,3),t.fillStyle(65484),t.fillRoundedRect(e,s,i,o,3)}this.add.text(a,n-h.displayHeight/2-30,"Patience",{fontSize:"32px",color:"#ffffff"}).setOrigin(.5),this.textBox.create("A wild Bug appeared...\nIt's a SYNTAX SPIDER!\n\nWhat will you do?")}updateEnemyHealthBar(){const{x:t,y:e,width:s,height:i}=this.enemyHealthBarInfo;this.enemyHealthBar.clear(),this.enemyHealthBar.fillStyle(0),this.enemyHealthBar.fillRoundedRect(t-2,e-2,s+4,i+4,3),this.enemyHealthBar.fillStyle(5592405),this.enemyHealthBar.fillRoundedRect(t,e,s,i,3);const a=this.enemyHealth/this.enemyMaxHealth*s;this.enemyHealthBar.fillStyle(65484),this.enemyHealthBar.fillRoundedRect(t,e,a,i,3)}exitBattle(){this.battleMusic.stop(),this.cameras.main.fadeOut(400,0,0,0,((t,e)=>{if(1===e){const t=this.scene.get("World");this.scene.resume("World"),t.cameras.main.resetFX(),t.cameras.main.fadeIn(400),t.time.delayedCall(2e3,(()=>{t.canEnterBattle=!0})),this.scene.stop("Battle"),this.onBattleEnd()}}))}}const f=[h,o,m,g],B={title:"GitHub Guardians",version:"1.0.0",width:p,height:x,type:n.AUTO,physics:{default:"arcade",arcade:{debug:!1}},disableContextMenu:!1,scale:{parent:"app",mode:n.Scale.FIT,autoCenter:n.Scale.CENTER_BOTH,min:{width:c,height:u},max:{width:p,height:x}},scene:[...f],zoom:1};new a.Game(B);
